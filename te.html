<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title id="page-title">èªçŸ¥æ©Ÿèƒ½ã®è©³ç´° â€” Persona Checker</title>
  <meta name="description" id="page-description" content="èªçŸ¥æ©Ÿèƒ½ã®æ·±å±¤åˆ†æ">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #ffffff;
      --bg-secondary: #f8fafc;
      --bg-gradient-start: #ffffff;
      --bg-gradient-end: #f1f5f9;
      --card-bg: #ffffff;
      --card-hover-bg: #f8fafc;
      --card-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      --card-shadow-hover: 0 8px 24px rgba(0, 0, 0, 0.12);
      --border: rgba(0, 0, 0, 0.08);
      --border-hover: rgba(59, 130, 246, 0.4);
      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-muted: #64748b;
      --accent-primary: #3b82f6;
      --accent-secondary: #8b5cf6;
      --accent-gradient: linear-gradient(135deg, #3b82f6, #8b5cf6);
      --accent-bg-light: rgba(59, 130, 246, 0.05);
      --accent-bg-medium: rgba(59, 130, 246, 0.1);
      --accent-border: rgba(59, 130, 246, 0.2);
      --success: #10b981;
      --warning: #f59e0b;
      --space-xs: 8px;
      --space-sm: 12px;
      --space-md: 16px;
      --space-lg: 24px;
      --space-xl: 32px;
      --space-2xl: 48px;
      --space-3xl: 64px;
      --font-family: Inter, ui-sans-serif, system-ui, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font-family);
      background: linear-gradient(180deg, var(--bg-gradient-start), var(--bg-gradient-end));
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      line-height: 1.6;
      min-height: 100vh;
    }

    .header {
      padding: var(--space-lg) 0;
      border-bottom: 1px solid var(--border);
      backdrop-filter: blur(10px);
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.95);
    }
    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 var(--space-lg);
      display: flex;
      align-items: center;
      gap: var(--space-lg);
    }
    .back-link {
      color: var(--accent-primary);
      text-decoration: none;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: var(--space-xs);
      transition: transform 0.3s ease;
    }
    .back-link:hover { transform: translateX(-4px); }
    .header-logo {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-md);
      background: var(--accent-gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 700;
      color: #ffffff;
      flex-shrink: 0;
    }

    .hero {
      max-width: 900px;
      margin: 0 auto;
      padding: var(--space-3xl) var(--space-lg) var(--space-2xl);
      text-align: center;
    }
    .function-badge {
      display: inline-flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-sm) var(--space-lg);
      background: var(--accent-bg-medium);
      border: 1px solid var(--accent-border);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-lg);
    }
    .function-code {
      font-family: var(--font-mono);
      font-size: 28px;
      font-weight: 800;
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .function-name {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
    }
    .tagline {
      font-size: clamp(20px, 4vw, 28px);
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: var(--space-xl);
      font-style: italic;
    }
    .tags {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-xs);
      justify-content: center;
      margin-bottom: var(--space-2xl);
    }
    .tag {
      padding: 6px 12px;
      background: var(--accent-bg-light);
      border: 1px solid var(--accent-border);
      border-radius: var(--radius-sm);
      font-size: 12px;
      font-weight: 600;
      color: var(--accent-primary);
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 0 var(--space-lg) var(--space-3xl);
    }

    .section {
      margin-bottom: var(--space-3xl);
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .section.visible {
      opacity: 1;
      transform: translateY(0);
    }
    .section-title {
      font-size: clamp(24px, 5vw, 32px);
      font-weight: 800;
      margin-bottom: var(--space-lg);
      color: var(--text-primary);
      position: relative;
      padding-left: var(--space-md);
    }
    .section-title::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      background: var(--accent-gradient);
      border-radius: 2px;
    }

    .lead {
      font-size: 18px;
      line-height: 1.8;
      color: var(--text-secondary);
      margin-bottom: var(--space-xl);
      padding: var(--space-lg);
      background: var(--accent-bg-light);
      border-left: 3px solid var(--accent-primary);
      border-radius: var(--radius-md);
    }

    .prose {
      font-size: 16px;
      line-height: 1.8;
      color: var(--text-secondary);
      margin-bottom: var(--space-lg);
    }
    .prose h3 {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      margin: var(--space-xl) 0 var(--space-md);
    }
    .prose h4 {
      font-size: 18px;
      font-weight: 600;
      color: var(--accent-primary);
      margin: var(--space-lg) 0 var(--space-sm);
    }
    .prose strong {
      color: var(--accent-primary);
      font-weight: 600;
    }
    .prose p {
      margin-bottom: var(--space-md);
    }
    .prose ul, .prose ol {
      margin-left: var(--space-lg);
      margin-bottom: var(--space-md);
    }
    .prose li {
      margin-bottom: var(--space-xs);
    }

    .characteristics {
      display: grid;
      gap: var(--space-lg);
    }
    .characteristic-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      transition: all 0.3s ease;
      box-shadow: var(--card-shadow);
    }
    .characteristic-card:hover {
      transform: translateY(-4px);
      border-color: var(--border-hover);
      box-shadow: var(--card-shadow-hover);
    }
    .characteristic-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--space-sm);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    .characteristic-icon {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      background: var(--accent-gradient);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      flex-shrink: 0;
    }
    .characteristic-desc {
      color: var(--text-secondary);
      line-height: 1.7;
      margin-bottom: var(--space-sm);
    }
    .characteristic-example {
      padding: var(--space-sm) var(--space-md);
      background: var(--bg-secondary);
      border-left: 2px solid var(--accent-primary);
      border-radius: var(--radius-sm);
      font-size: 14px;
      color: var(--text-muted);
      font-style: italic;
    }

    .strengths-weaknesses {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--space-lg);
    }
    .sw-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      box-shadow: var(--card-shadow);
    }
    .sw-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: var(--space-md);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    .sw-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }
    .sw-list li {
      padding-left: var(--space-lg);
      position: relative;
      color: var(--text-secondary);
      line-height: 1.6;
    }
    .sw-list li::before {
      content: 'â€¢';
      position: absolute;
      left: 0;
      font-weight: 700;
      font-size: 20px;
    }
    .strengths li::before { color: var(--success); }
    .weaknesses li::before { color: var(--warning); }

    .comparison-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-xl);
      margin-bottom: var(--space-lg);
      box-shadow: var(--card-shadow);
    }
    .comparison-header {
      font-size: 22px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--space-md);
      text-align: center;
    }
    .comparison-vs {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-lg);
      margin-bottom: var(--space-lg);
    }
    .comparison-function {
      font-family: var(--font-mono);
      font-size: 32px;
      font-weight: 800;
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .comparison-divider {
      font-size: 20px;
      color: var(--text-muted);
      font-weight: 600;
    }
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: var(--space-lg) 0;
    }
    .comparison-table th {
      background: var(--bg-secondary);
      padding: var(--space-sm) var(--space-md);
      text-align: left;
      font-weight: 600;
      color: var(--text-primary);
      border-bottom: 2px solid var(--border);
    }
    .comparison-table td {
      padding: var(--space-sm) var(--space-md);
      border-bottom: 1px solid var(--border);
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .quote-box {
      background: var(--card-bg);
      border: 1px solid var(--accent-border);
      padding: var(--space-xl);
      margin: var(--space-xl) 0;
      border-radius: var(--radius-lg);
      position: relative;
      box-shadow: var(--card-shadow);
    }
    .quote-box::before {
      content: '"';
      position: absolute;
      top: 10px;
      left: 20px;
      font-size: 80px;
      font-weight: 800;
      color: rgba(59, 130, 246, 0.08);
      font-family: var(--font-mono);
      line-height: 1;
    }
    .quote-text {
      font-size: 16px;
      line-height: 1.7;
      font-style: italic;
      color: var(--text-secondary);
      margin-bottom: var(--space-xs);
      position: relative;
      z-index: 1;
    }
    .quote-author {
      font-size: 14px;
      text-align: right;
      color: var(--accent-primary);
      font-family: var(--font-mono);
      font-weight: 600;
    }

    .warning-box {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(245, 158, 11, 0.02));
      border: 1px solid rgba(245, 158, 11, 0.3);
      padding: var(--space-lg);
      border-radius: var(--radius-md);
      margin: var(--space-lg) 0;
    }
    .warning-title {
      font-weight: 700;
      color: var(--warning);
      margin-bottom: var(--space-sm);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    .warning-content {
      color: var(--text-secondary);
      line-height: 1.7;
      font-size: 15px;
    }

    .info-box {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(59, 130, 246, 0.02));
      border: 1px solid var(--accent-border);
      padding: var(--space-lg);
      border-radius: var(--radius-md);
      margin: var(--space-lg) 0;
    }
    .info-title {
      font-weight: 700;
      color: var(--accent-primary);
      margin-bottom: var(--space-sm);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    .info-content {
      color: var(--text-secondary);
      line-height: 1.7;
      font-size: 15px;
    }

    .examples-grid {
      display: grid;
      gap: var(--space-md);
    }
    .example-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-md);
      box-shadow: var(--card-shadow);
    }
    .example-category {
      font-weight: 700;
      color: var(--accent-primary);
      margin-bottom: var(--space-xs);
      font-size: 14px;
    }
    .example-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: var(--space-xs);
    }
    .example-list li {
      padding-left: var(--space-md);
      position: relative;
      color: var(--text-secondary);
      font-size: 14px;
      line-height: 1.6;
    }
    .example-list li::before {
      content: 'â†’';
      position: absolute;
      left: 0;
      color: var(--accent-primary);
      font-weight: 700;
    }

    .famous-grid {
      display: grid;
      gap: var(--space-lg);
    }
    .famous-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      box-shadow: var(--card-shadow);
      transition: all 0.3s ease;
    }
    .famous-card:hover {
      transform: translateY(-4px);
      border-color: var(--border-hover);
      box-shadow: var(--card-shadow-hover);
    }
    .famous-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: var(--space-sm);
      flex-wrap: wrap;
      gap: var(--space-xs);
    }
    .famous-name {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
    }
    .famous-type {
      font-family: var(--font-mono);
      font-size: 14px;
      font-weight: 700;
      color: var(--accent-primary);
    }
    .famous-reason {
      color: var(--text-secondary);
      line-height: 1.7;
      margin-bottom: var(--space-sm);
      font-size: 15px;
    }
    .famous-quote {
      padding: var(--space-sm) var(--space-md);
      background: var(--bg-secondary);
      border-left: 2px solid var(--accent-primary);
      border-radius: var(--radius-sm);
      font-size: 14px;
      color: var(--text-muted);
      font-style: italic;
    }

    .stages-grid {
      display: grid;
      gap: var(--space-lg);
    }
    .stage-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      box-shadow: var(--card-shadow);
    }
    .stage-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: var(--space-md);
      flex-wrap: wrap;
      gap: var(--space-sm);
    }
    .stage-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
    }
    .stage-age {
      font-family: var(--font-mono);
      font-size: 14px;
      font-weight: 600;
      color: var(--accent-primary);
    }

    .types-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--space-md);
    }
    .type-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-md);
      box-shadow: var(--card-shadow);
      transition: all 0.3s ease;
    }
    .type-card:hover {
      transform: translateY(-4px);
      border-color: var(--border-hover);
      box-shadow: var(--card-shadow-hover);
    }
    .type-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-sm);
    }
    .type-code {
      font-family: var(--font-mono);
      font-size: 20px;
      font-weight: 800;
      background: var(--accent-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .type-percentage {
      font-size: 12px;
      color: var(--text-muted);
    }
    .type-nickname {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-xs);
    }
    .type-stack {
      font-family: var(--font-mono);
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: var(--space-xs);
    }
    .type-desc {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .footer {
      padding: var(--space-2xl) var(--space-lg);
      border-top: 1px solid var(--border);
      text-align: center;
      background: var(--bg-secondary);
    }
    .footer-text {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: var(--space-sm);
    }
    .footer-note {
      font-size: 12px;
      color: var(--text-muted);
      font-style: italic;
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.6;
    }

    @media (max-width: 768px) {
      .hero { padding: var(--space-2xl) var(--space-lg); }
      .section-title { font-size: 24px; }
      .comparison-vs { flex-direction: column; gap: var(--space-sm); }
      .strengths-weaknesses { grid-template-columns: 1fr; }
      .comparison-table { font-size: 14px; }
      .comparison-table th, .comparison-table td { padding: var(--space-xs) var(--space-sm); }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <a href="index.html" class="back-link">
        <span>â†</span>
        <span>æˆ»ã‚‹</span>
      </a>
      <div class="header-logo">Î¨</div>
    </div>
  </header>

  <section class="hero">
    <div class="function-badge">
      <span class="function-code" id="hero-code">--</span>
      <span class="function-name" id="hero-name">èª­ã¿è¾¼ã¿ä¸­...</span>
    </div>
    <h1 class="tagline" id="hero-tagline">èªçŸ¥æ©Ÿèƒ½ã®æ·±å±¤åˆ†æ</h1>
    <div class="tags" id="hero-tags"></div>
  </section>

  <main class="container" id="main-content">
    <div class="info-box">
      <div class="info-title">ğŸ“– èª­ã¿è¾¼ã¿ä¸­...</div>
      <div class="info-content">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™ã€‚å°‘ã€…ãŠå¾…ã¡ãã ã•ã„ã€‚</div>
    </div>
  </main>

  <footer class="footer">
    <p class="footer-text">Persona Checker - èªçŸ¥æ©Ÿèƒ½åˆ†æ</p>
    <p class="footer-note">
      ã“ã®ãƒšãƒ¼ã‚¸ã¯ Carl Jung ã®èªçŸ¥æ©Ÿèƒ½ç†è«–ã‚’åŸºã«ã—ãŸåˆ†æã§ã™ã€‚
      ç§‘å­¦çš„å¦¥å½“æ€§ã¯é™å®šçš„ã§ã‚ã‚Šã€è‡ªå·±ç†è§£ã®è£œåŠ©çš„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨ã—ã¦ã”åˆ©ç”¨ãã ã•ã„ã€‚
    </p>
  </footer>

  <script>
    const params = new URLSearchParams(location.search);
    const code = (params.get('code') || params.get('func') || 'te').toLowerCase();

    async function loadData() {
      try {
        const res = await fetch(`data/${code}.json`);
        if (!res.ok) throw new Error(`${code}.json ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
        const data = await res.json();

        // ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«è¨­å®š
        document.getElementById('page-title').textContent = 
          `${data.name}ï¼ˆ${data.code}ï¼‰å®Œå…¨ã‚¬ã‚¤ãƒ‰ â€” Persona Checker`;

        // ãƒ’ãƒ¼ãƒ­ãƒ¼
        document.getElementById('hero-code').textContent = data.code || '';
        document.getElementById('hero-name').textContent = data.name || data.nameEn || '';
        document.getElementById('hero-tagline').textContent = data.tagline || '';
        
        const tagsContainer = document.getElementById('hero-tags');
        if (data.tags && Array.isArray(data.tags)) {
          tagsContainer.innerHTML = data.tags
            .map(tag => `<span class="tag">${e(tag)}</span>`)
            .join('');
        }

        // ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆ
        let html = '';

        // æ¦‚è¦
        if (data.overview) {
          html += `<section class="section">
            <h2 class="section-title">ã“ã®æ©Ÿèƒ½ã®æœ¬è³ª</h2>
            <div class="lead">${e(data.overview.short || data.overview.oneLiner || '')}</div>`;
          
          if (data.overview.long) {
            html += '<div class="prose">';
            for (const [key, value] of Object.entries(data.overview.long)) {
              const title = {
                essence: 'æœ¬è³ª',
                mechanism: 'ä»•çµ„ã¿',
                comparison: 'ä»–æ©Ÿèƒ½ã¨ã®é•ã„',
                jungView: 'Jungã®è¦‹è§£'
              }[key] || key;
              html += `<h3>${title}</h3><p>${nl2br(e(value))}</p>`;
            }
            html += '</div>';
          }
          html += '</section>';
        }

        // ç¥çµŒç§‘å­¦çš„åŸºç›¤
        if (data.cognitiveScience) {
          html += `<section class="section">
            <h2 class="section-title">è„³ç§‘å­¦ã‹ã‚‰è¦‹ãŸãƒ¡ã‚«ãƒ‹ã‚ºãƒ </h2>`;
          
          if (data.cognitiveScience.neuralBasis) {
            html += `<div class="prose">${nl2br(e(data.cognitiveScience.neuralBasis))}</div>`;
          }
          
          if (data.cognitiveScience.relatedProcesses && Array.isArray(data.cognitiveScience.relatedProcesses)) {
            html += '<div class="prose"><h3>é–¢é€£ã™ã‚‹èªçŸ¥ãƒ—ãƒ­ã‚»ã‚¹</h3></div>';
            data.cognitiveScience.relatedProcesses.forEach(proc => {
              html += `<div class="info-box">
                <div class="info-title">${e(proc.process)}</div>
                <div class="info-content">
                  <p>${e(proc.relation)}</p>
                  ${proc.research ? `<p><em>å‚è€ƒï¼š${e(proc.research)}</em></p>` : ''}
                </div>
              </div>`;
            });
          }
          html += '</section>';
        }

        // ç‰¹æ€§
        if (data.characteristics && Array.isArray(data.characteristics)) {
          html += `<section class="section">
            <h2 class="section-title">5ã¤ã®ç‰¹æ€§</h2>
            <div class="characteristics">`;
          
          data.characteristics.forEach((char, i) => {
            html += `<div class="characteristic-card">
              <div class="characteristic-title">
                <span class="characteristic-icon">${i + 1}</span>
                <span>${e(char.title || '')}</span>
              </div>
              <p class="characteristic-desc">${e(char.description || '')}</p>
              ${char.example ? `<div class="characteristic-example">ä¾‹ï¼š${e(char.example)}</div>` : ''}
            </div>`;
          });
          
          html += '</div></section>';
        }

        // å¼·ã¿ãƒ»å¼±ã¿
        html += `<section class="section">
          <h2 class="section-title">å¼·ã¿ã¨å¼±ã¿</h2>
          <div class="strengths-weaknesses">
            <div class="sw-card">
              <div class="sw-title"><span>âœ“</span><span>å¼·ã¿</span></div>
              <ul class="sw-list strengths">`;
        
        if (data.strengths && Array.isArray(data.strengths)) {
          data.strengths.forEach(s => {
            html += `<li>${e(s)}</li>`;
          });
        }
        
        html += `</ul></div><div class="sw-card">
          <div class="sw-title"><span>âš </span><span>å¼±ã¿</span></div>
              <ul class="sw-list weaknesses">`;
        
        if (data.weaknesses && Array.isArray(data.weaknesses)) {
          data.weaknesses.forEach(w => {
            html += `<li>${e(w)}</li>`;
          });
        }
        
        html += `</ul></div></div></section>`;

        // å®Ÿç”Ÿæ´»ã§ã®ä¾‹
        if (data.realLifeExamples) {
          html += `<section class="section">
            <h2 class="section-title">å®Ÿç”Ÿæ´»ã§ã®ç¾ã‚Œæ–¹</h2>
            <div class="examples-grid">`;
          
          for (const [category, examples] of Object.entries(data.realLifeExamples)) {
            if (Array.isArray(examples)) {
              const categoryName = {
                work: 'ä»•äº‹',
                relationships: 'äººé–“é–¢ä¿‚',
                learning: 'å­¦ç¿’',
                hobbies: 'è¶£å‘³ãƒ»ä½™æš‡'
              }[category] || category;
              
              html += `<div class="example-card">
                <div class="example-category">${categoryName}</div>
                <ul class="example-list">`;
              
              examples.forEach(ex => {
                html += `<li>${e(ex)}</li>`;
              });
              
              html += `</ul></div>`;
            }
          }
          
          html += `</div></section>`;
        }

        // æ¯”è¼ƒ
        if (data.comparisons && data.comparisons.polarOpposite) {
          const comp = data.comparisons.polarOpposite;
          html += `<section class="section">
            <h2 class="section-title">ä»–ã®æ©Ÿèƒ½ã¨ã®æ¯”è¼ƒ</h2>
            <div class="comparison-card">
              <div class="comparison-header">${e(comp.title || '')}</div>
              <div class="comparison-vs">
                <span class="comparison-function">${data.code}</span>
                <span class="comparison-divider">vs</span>
                <span class="comparison-function">${comp.function}</span>
              </div>`;
          
          if (comp.keyDifferences && Array.isArray(comp.keyDifferences)) {
            html += `<table class="comparison-table">
              <thead>
                <tr>
                  <th>è¦³ç‚¹</th>
                  <th>${data.code}</th>
                  <th>${comp.function}</th>
                </tr>
              </thead>
              <tbody>`;
            
            comp.keyDifferences.forEach(diff => {
              html += `<tr>
                <td><strong>${e(diff.aspect)}</strong></td>
                <td>${e(diff[data.code] || '')}</td>
                <td>${e(diff[comp.function] || '')}</td>
              </tr>`;
            });
            
            html += `</tbody></table>`;
          }

          if (comp.integration) {
            html += `<div class="info-box">
              <div class="info-title">ğŸ’¡ çµ±åˆã®ãƒ’ãƒ³ãƒˆ</div>
              <div class="info-content">${e(comp.integration)}</div>
            </div>`;
          }
          
          html += `</div></section>`;
        }

        // ã‚¹ã‚¿ãƒƒã‚¯åˆ¥ãƒ€ã‚¤ãƒŠãƒŸã‚¯ã‚¹
        if (data.comparisons && data.comparisons.stackDynamics) {
          const stack = data.comparisons.stackDynamics;
          html += `<section class="section">
            <h2 class="section-title">æ©Ÿèƒ½ã‚¹ã‚¿ãƒƒã‚¯ã«ãŠã‘ã‚‹å½¹å‰²</h2>`;
          
          ['asDominant', 'asAuxiliary', 'asTertiary', 'asInferior'].forEach(position => {
            if (stack[position]) {
              const pos = stack[position];
              const posName = {
                asDominant: 'ä¸»æ©Ÿèƒ½ã¨ã—ã¦',
                asAuxiliary: 'è£œåŠ©æ©Ÿèƒ½ã¨ã—ã¦',
                asTertiary: 'ç¬¬ä¸‰æ©Ÿèƒ½ã¨ã—ã¦',
                asInferior: 'åŠ£ç­‰æ©Ÿèƒ½ã¨ã—ã¦'
              }[position];
              
              html += `<div class="info-box">
                <div class="info-title">${posName}</div>
                <div class="info-content">`;
              
              if (pos.types && Array.isArray(pos.types)) {
                html += `<p><strong>å¯¾è±¡ã‚¿ã‚¤ãƒ—ï¼š</strong>${pos.types.join(', ')}</p>`;
              }
              if (pos.percentage) {
                html += `<p><strong>äººå£æ¯”ï¼š</strong>${e(pos.percentage)}</p>`;
              }
              if (pos.role) {
                html += `<p>${e(pos.role)}</p>`;
              }
              if (pos.strengths && Array.isArray(pos.strengths)) {
                html += `<p><strong>å¼·ã¿ï¼š</strong></p><ul>`;
                pos.strengths.forEach(s => html += `<li>${e(s)}</li>`);
                html += `</ul>`;
              }
              if (pos.challenges && Array.isArray(pos.challenges)) {
                html += `<p><strong>èª²é¡Œï¼š</strong></p><ul>`;
                pos.challenges.forEach(c => html += `<li>${e(c)}</li>`);
                html += `</ul>`;
              }
              
              html += `</div></div>`;
            }
          });
          
          html += `</section>`;
        }

        // ç™ºé”æ®µéš
        if (data.developmentalStages) {
          html += `<section class="section">
            <h2 class="section-title">äººç”Ÿã®ç™ºé”æ®µéš</h2>
            <div class="stages-grid">`;
          
          for (const [stage, info] of Object.entries(data.developmentalStages)) {
            const stageName = {
              childhood: 'å­ã©ã‚‚æ™‚ä»£',
              adolescence: 'é’å¹´æœŸ',
              adulthood: 'æˆäººæœŸ',
              maturity: 'æˆç†ŸæœŸ'
            }[stage] || stage;
            
            html += `<div class="stage-card">
              <div class="stage-header">
                <div class="stage-title">${stageName}</div>
                ${info.age ? `<div class="stage-age">${e(info.age)}</div>` : ''}
              </div>`;
            
            if (info.characteristics && Array.isArray(info.characteristics)) {
              html += `<div class="prose"><h4>ç‰¹å¾´</h4><ul>`;
              info.characteristics.forEach(c => html += `<li>${e(c)}</li>`);
              html += `</ul></div>`;
            }
            
            if (info.challenges && Array.isArray(info.challenges)) {
              html += `<div class="prose"><h4>èª²é¡Œ</h4><ul>`;
              info.challenges.forEach(c => html += `<li>${e(c)}</li>`);
              html += `</ul></div>`;
            }
            
            if (info.support) {
              html += `<div class="info-box">
                <div class="info-title">ğŸ’¡ ã‚µãƒãƒ¼ãƒˆ</div>
                <div class="info-content">${nl2br(e(info.support))}</div>
              </div>`;
            }
            
            if (info.wisdom) {
              html += `<div class="quote-box">
                <p class="quote-text">${e(info.wisdom)}</p>
              </div>`;
            }
            
            html += `</div>`;
          }
          
          html += `</div></section>`;
        }

        // å®Ÿç”¨çš„å¿œç”¨
        if (data.practicalApplications) {
          html += `<section class="section">
            <h2 class="section-title">å®Ÿç”¨çš„ãªå¿œç”¨æ–¹æ³•</h2>`;
          
          if (data.practicalApplications.career) {
            const career = data.practicalApplications.career;
            html += `<div class="prose"><h3>ã‚­ãƒ£ãƒªã‚¢</h3>`;
            
            if (career.ideal && Array.isArray(career.ideal)) {
              html += `<h4>é©ã—ãŸè·æ¥­</h4><ul>`;
              career.ideal.forEach(job => html += `<li>${e(job)}</li>`);
              html += `</ul>`;
            }
            
            if (career.challenges && Array.isArray(career.challenges)) {
              html += `<h4>ã‚­ãƒ£ãƒªã‚¢ä¸Šã®èª²é¡Œ</h4><ul>`;
              career.challenges.forEach(ch => html += `<li>${e(ch)}</li>`);
              html += `</ul>`;
            }
            
            if (career.strategies && Array.isArray(career.strategies)) {
              html += `<h4>æˆ¦ç•¥</h4><ul>`;
              career.strategies.forEach(st => html += `<li>${e(st)}</li>`);
              html += `</ul>`;
            }
            
            html += `</div>`;
          }
          
          if (data.practicalApplications.problemSolving) {
            const ps = data.practicalApplications.problemSolving;
            html += `<div class="prose"><h3>å•é¡Œè§£æ±º</h3>`;
            
            if (ps.approach) {
              html += `<p>${e(ps.approach)}</p>`;
            }
            
            if (ps.process && Array.isArray(ps.process)) {
              html += `<h4>ãƒ—ãƒ­ã‚»ã‚¹</h4><ol>`;
              ps.process.forEach(step => html += `<li>${e(step)}</li>`);
              html += `</ol>`;
            }
            
            html += `</div>`;
          }
          
          html += `</section>`;
        }

        // ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ—ãƒ­ã‚°ãƒ©ãƒ 
        if (data.trainingProgram) {
          html += `<section class="section">
            <h2 class="section-title">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ—ãƒ­ã‚°ãƒ©ãƒ </h2>`;
          
          ['beginner', 'intermediate', 'advanced'].forEach(level => {
            if (data.trainingProgram[level]) {
              const prog = data.trainingProgram[level];
              const levelName = {
                beginner: 'åˆç´š',
                intermediate: 'ä¸­ç´š',
                advanced: 'ä¸Šç´š'
              }[level];
              
              html += `<div class="info-box">
                <div class="info-title">${levelName}ï¼š${e(prog.goal || '')}</div>
                <div class="info-content">`;
              
              if (prog.duration) {
                html += `<p><strong>æœŸé–“ï¼š</strong>${e(prog.duration)}</p>`;
              }
              
              if (prog.exercises && Array.isArray(prog.exercises)) {
                html += `<h4>ã‚¨ã‚¯ã‚µã‚µã‚¤ã‚º</h4>`;
                prog.exercises.forEach(ex => {
                  html += `<div style="margin-bottom: 1rem;">
                    <p><strong>${e(ex.name)}</strong></p>
                    <p>${e(ex.description)}</p>
                    ${ex.frequency ? `<p><em>é »åº¦ï¼š${e(ex.frequency)}</em></p>` : ''}
                  </div>`;
                });
              }
              
              html += `</div></div>`;
            }
          });
          
          html += `</section>`;
        }

        // æœ‰åäºº
        if (data.famousPeople && Array.isArray(data.famousPeople)) {
          html += `<section class="section">
            <h2 class="section-title">ã“ã®æ©Ÿèƒ½ã‚’æŒã¤æœ‰åäºº</h2>
            <div class="famous-grid">`;
          
          data.famousPeople.forEach(person => {
            html += `<div class="famous-card">
              <div class="famous-header">
                <div class="famous-name">${e(person.name)}</div>
                ${person.type ? `<div class="famous-type">${e(person.type)}</div>` : ''}
              </div>
              ${person.reason ? `<p class="famous-reason">${e(person.reason)}</p>` : ''}
              ${person.quote ? `<div class="famous-quote">"${e(person.quote)}"</div>` : ''}
            </div>`;
          });
          
          html += `</div></section>`;
        }

        // Jung ã®å¼•ç”¨
        if (data.history) {
          html += `<section class="section">
            <h2 class="section-title">Jung ã®è¦–ç‚¹</h2>`;
          
          if (data.history.jungQuote) {
            html += `<div class="quote-box">
              <p class="quote-text">${e(data.history.jungQuote)}</p>
              ${data.history.jungSource ? `<p class="quote-author">${e(data.history.jungSource)}</p>` : ''}
            </div>`;
          }
          
          if (data.history.context) {
            html += `<div class="prose"><p>${nl2br(e(data.history.context))}</p></div>`;
          }
          
          if (data.history.warning) {
            html += `<div class="warning-box">
              <div class="warning-title">âš  Jung ã®è­¦å‘Š</div>
              <div class="warning-content">${nl2br(e(data.history.warning))}</div>
            </div>`;
          }
          
          if (data.history.historicalFigures && Array.isArray(data.history.historicalFigures)) {
            html += `<div class="prose"><h3>æ­´å²ä¸Šã®äººç‰©</h3></div>`;
            data.history.historicalFigures.forEach(fig => {
              html += `<div class="info-box">
                <div class="info-title">${e(fig.name)} ${fig.period ? `ï¼ˆ${e(fig.period)}ï¼‰` : ''}</div>
                <div class="info-content">
                  ${fig.contribution ? `<p>${e(fig.contribution)}</p>` : ''}
                  ${fig.quote ? `<p><em>"${e(fig.quote)}"</em></p>` : ''}
                </div>
              </div>`;
            });
          }
          
          html += `</section>`;
        }

        // æ–‡åŒ–çš„æ–‡è„ˆ
        if (data.culturalContext) {
          html += `<section class="section">
            <h2 class="section-title">æ–‡åŒ–çš„æ–‡è„ˆ</h2>
            <div class="prose">`;
          
          if (data.culturalContext.western) {
            html += `<h3>è¥¿æ´‹ã«ãŠã‘ã‚‹è©•ä¾¡</h3><p>${nl2br(e(data.culturalContext.western))}</p>`;
          }
          
          if (data.culturalContext.japanese) {
            html += `<h3>æ—¥æœ¬ã«ãŠã‘ã‚‹è©•ä¾¡</h3><p>${nl2br(e(data.culturalContext.japanese))}</p>`;
          }
          
          if (data.culturalContext.balance) {
            html += `<h3>ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚Šæ–¹</h3><p>${nl2br(e(data.culturalContext.balance))}</p>`;
          }
          
          html += `</div></section>`;
        }

        // ã‚ˆãã‚ã‚‹èª¤è§£
        if (data.misconceptions && Array.isArray(data.misconceptions)) {
          html += `<section class="section">
            <h2 class="section-title">ã‚ˆãã‚ã‚‹èª¤è§£</h2>`;
          
          data.misconceptions.forEach((misc, i) => {
            html += `<div class="comparison-card">
              <div class="comparison-header">èª¤è§£ ${i + 1}ï¼š${e(misc.myth)}</div>
              <div class="prose">
                <h4>çœŸå®Ÿ</h4>
                <p>${nl2br(e(misc.truth))}</p>
                ${misc.evidence ? `<p><em>æ ¹æ‹ ï¼š${e(misc.evidence)}</em></p>` : ''}
                ${misc.clarification ? `<p>${e(misc.clarification)}</p>` : ''}
              </div>
            </div>`;
          });
          
          html += `</section>`;
        }

        // ç§‘å­¦çš„é™ç•Œ
        if (data.cognitiveScience && data.cognitiveScience.limitations) {
          html += `<section class="section">
            <h2 class="section-title">ç§‘å­¦çš„é™ç•Œ</h2>
            <div class="warning-box">
              <div class="warning-title">âš  æ­£ç›´ãªé–‹ç¤º</div>
              <div class="warning-content">${nl2br(e(data.cognitiveScience.limitations.scientificCaveats || ''))}</div>
            </div>`;
          
          if (data.cognitiveScience.limitations.howToCompensate) {
            const comp = data.cognitiveScience.limitations.howToCompensate;
            html += `<div class="info-box">
              <div class="info-title">ğŸ’¡ ${e(comp.title || 'é™ç•Œã‚’è£œã†æ–¹æ³•')}</div>
              <div class="info-content">`;
            
            if (comp.strategies && Array.isArray(comp.strategies)) {
              comp.strategies.forEach(strat => {
                html += `<div style="margin-bottom: 1rem;">
                  <p><strong>${e(strat.limitation)}</strong></p>
                  <p>è£œå®Œæ©Ÿèƒ½ï¼š<strong>${e(strat.compensatingFunction)}</strong></p>
                  <p>${e(strat.integration)}</p>
                </div>`;
              });
            }
            
            if (comp.balancedApproach) {
              html += `<p><strong>ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼š</strong>${e(comp.balancedApproach)}</p>`;
            }
            
            html += `</div></div>`;
          }
          
          html += `</section>`;
        }

        // é–¢é€£æ¦‚å¿µ
        if (data.relatedConcepts && Array.isArray(data.relatedConcepts)) {
          html += `<section class="section">
            <h2 class="section-title">é–¢é€£æ¦‚å¿µ</h2>`;
          
          data.relatedConcepts.forEach(concept => {
            html += `<div class="info-box">
              <div class="info-title">${e(concept.term)}</div>
              <div class="info-content">
                <p>${e(concept.relation)}</p>
                ${concept.reference ? `<p><em>å‚è€ƒï¼š${e(concept.reference)}</em></p>` : ''}
              </div>
            </div>`;
          });
          
          html += `</section>`;
        }

        // HTMLã‚’æŒ¿å…¥
        document.getElementById('main-content').innerHTML = html;

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        observeSections();

      } catch (e) {
        document.getElementById('main-content').innerHTML = 
          `<div class="warning-box">
            <div class="warning-title">âš  ã‚¨ãƒ©ãƒ¼</div>
            <div class="warning-content">${e.message}</div>
          </div>`;
      }
    }

    function e(str) {
      if (!str) return '';
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    function nl2br(str) {
      return str.replace(/\n\n/g, '</p><p>').replace(/\n/g, '<br>');
    }

    function observeSections() {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });

      document.querySelectorAll('.section').forEach(section => {
        observer.observe(section);
      });
    }

    loadData();
  </script>
</body>
</html>